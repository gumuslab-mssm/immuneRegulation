
<!DOCTYPE html>
<html lang="en">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="//igv.org/web/img/favicon.ico">
    <title>ImmuneRegulation</title>

    <!-- Bootstrap CSS - NOT REQUIRED FOR IGV -->
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

    <!-- jQuery UI CSS -->
    <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.2/themes/smoothness/jquery-ui.css"/>

    <!-- Font Awesome CSS -->
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css">

    <link rel="shortcut icon" href="//igv.org/web/img/favicon.ico">

    <!-- IGV CSS -->
    <link rel="stylesheet" type="text/css" href="https://igv.org/web/beta/igv.css">


    <!-- DataTables CSS -->
    <link rel="stylesheet" type="text/css" href="//cdn.datatables.net/1.10.13/css/jquery.dataTables.css">
    <link rel="stylesheet" type="text/css" src="./css/typeahead.css">

    <!--link rel="stylesheet" type="text/css" src="./css/jquery.dataTables.min.css"-->

    <!-- jQuery JS -->
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.2/jquery-ui.min.js"></script>

    <!-- Bootstrap JS -  NOT REQUIRED FOR IGV -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>


    <!-- IGV JS - Deneme DEV -->
    <script src="./js/igv-immuneregulation.js"></script>


    <!-- D3 JS -->
    <script src='https://d3js.org/d3.v3.min.js'></script>
    <script src="https://labratrevenge.com/d3-tip/javascripts/d3.tip.v0.6.3.js"></script>

    <!-- Bootstrap Multi-Select -->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-multiselect/0.9.13/js/bootstrap-multiselect.min.js" integrity="sha256-1fK87Pt9T7XXn/Vj3CWSfJlZkL5f73092A8YL7p7avc=" crossorigin="anonymous"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-multiselect/0.9.13/css/bootstrap-multiselect.css" integrity="sha256-O1jJhOIWWDc3wq75g7aXDl7aEQT2XPkieX/Mz/u4hQ0=" crossorigin="anonymous"/>    
    
    <!-- DataTables JS -->
    <script type="text/javascript" charset="utf8" src="//cdn.datatables.net/1.10.13/js/jquery.dataTables.js"></script>
    <script src="./js/underscore-min.js"></script>
    <script src="./js/type.js"></script>
    <script src="./js/genenames.js"></script>

    <!--script type="text/javascript" charset="utf8" src="./js/jquery.dataTables.min.js"></script-->

    
<style type="text/css">
    
#custom-search-input {
        margin:0;
        margin-top: 10px;
        padding: 0;
    }
 
    #custom-search-input .search-query {
        padding-right: 3px;
        padding-right: 4px \9;
        padding-left: 3px;
        padding-left: 4px \9;
        /* IE7-8 doesn't have border-radius, so don't indent the padding */
 
        margin-bottom: 0;
        -webkit-border-radius: 3px;
        -moz-border-radius: 3px;
        border-radius: 3px;
    }
 
    #custom-search-input button {
        border: 0;
        background: none;
        /** belows styles are working good */
        padding: 2px 5px;
        margin-top: 2px;
        position: relative;
        left: -28px;
        /* IE7-8 doesn't have border-radius, so don't indent the padding */
        margin-bottom: 0;
        -webkit-border-radius: 3px;
        -moz-border-radius: 3px;
        border-radius: 3px;
        color:#D9230F;
    }
 
    .search-query:focus + button {
        z-index: 3;   
    }
.graph-svg-component {
    background-color: AliceBlue;
}

.filter {
  display: inline-block;
}

#geneSearch {
    background: #1974B8;  
}

#geneSearch:hover {
    background: #035b9c;   
}

#geneSearch:active {
    background: #1974B8;   
}

.btn, .btn-primary {
    background: white;
    padding: 14px 24px;
    font-weight: 400;
    letter-spacing: 1px;
    border-radius: 0;
    border: 1 solid;
    border-color: #bbb;
}

.btn-group, .btn-group-vertical {
    margin-left: 10px;
}

.btn:focus, .btn:active:focus, .btn.active:focus {
    outline: 0 none;
    border: 2 solid;
    border-color: #bbb;
}

.btn-primary.active, .btn-primary:focus, .btn-primary:active, .open > .dropdown-toggle.btn-primary {
    background: lightgray;
    color: #000;
    
    box-shadow: none;
    border: 1 solid;
    border-color: #bbb;
}

.btn-primary:hover {
    background: #bbb;
    border: 1 solid;
    border-color: #bbb;
}

.btn-primary:active, .btn-primary.raised.active {
    background: lightgray;
    box-shadow: none;
    margin-bottom: -3px;
    margin-top: 3px;
    border: 1 solid;
    border-color: #bbb;
}

.btn-primary.disabled, .btn-primary.disabled:focus, .btn-primary.disabled:active {
    background: lightgray;
    color: white;
    opacity: .7;
    border: 1 solid;
    border-color: #bbb;
}

circle {
    fill-opacity: .7;
    fill: rgb(30,144,255);
    stroke: #aaa; 
}

circle:hover {
  fill: red;
  stroke: #ccc;
}

caption {
    font-size:medium;
    text-align: center;
    color: blue;

}

table {
    font-size: medium;
}

path.line {
  fill: none;
  stroke: #666;
  stroke-width: 1.5px;
}

path.area {
  fill: #e7e7e7;
}

.axis {
  shape-rendering: crispEdges;
}

.x.axis line {
  stroke: #fff;
}

.x.axis .minor {
  stroke-opacity: .5;
}

.x.axis path {
  display: none;
}

.y.axis line,
.y.axis path {
  fill: none;
  stroke: #000;
}

.axis--y text {
  font: oblique 10px Georgia, serif;
}

div.tooltip {   
    position: absolute;         
    text-align: left;         
    width: 160px;                    
    height: auto;                   
    padding: 10px;               
    font: 12px sans-serif;      
    background: lightsteelblue; 
    border: 0px;        
    border-radius: 8px;
    box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.4);         
    pointer-events: none;           
}

.navbar-nav:hover {
    background: #77b7ec;
}

.navbar-nav>.open {
    background: #1974B8;
}

.navbar-nav > li > a:active {
    font-size: larger;
}

.navbar-nav > li > a:focus {
    font-size: larger;

}

.navbar-inverse .navbar-nav>.open>a, .navbar-inverse .navbar-nav>.open>a:focus, .navbar-inverse .navbar-nav>.open>a:hover {
    background: #77b7ec;
}

.chart div {
  font: 10px sans-serif;
  background-color: steelblue;
  text-align: right;
  padding: 3px;
  margin: 1px;
  color: white;
}

.bar {
  fill: lightsteelblue;
  stroke: gray;
}

.bar:hover {
  fill: steelblue ;
  stroke: black;
}

.indbar {
  fill: bisque;
  stroke: gray;
}

.indbar:hover {
  fill: orange ;
}

.d3-tip {
  line-height: 1;
  font-weight: bold;
  padding: 8px;
  background: rgba(255, 255, 255, 0.8);
  border: 1px;
  border-color: black;
  color: black;
  border-radius: 4px;
  border: 1px solid #444;
  /*border-radius: 2px;*/
}

/* Creates a small triangle extender for the tooltip */
.d3-tip:after {
  box-sizing: border-box;
  display: inline;
  font-size: 10px;
  width: 100%;
  line-height: 1;
  color: rgba(0, 0, 0, 0.8);
  content: "\25BC";

  position: absolute;
  text-align: center;
}

/* Style northward tooltips differently */
.d3-tip.n:after {
  margin: -1px 0 0 0;
  top: 100%;
  left: 0;
  border: 1px;
  border-color: grey;
}

</style>

<script type="text/javascript">

    $(document).ready(function() {
        $('#example').DataTable( {
            "paging":   false,
            "ordering": false,
            "info":     false,
            "filter": false
        } );
    } );

    var HLAData = [];

    d3.tsv("./data/hipc/zikv/Zika-HLA-4.tsv", function(data) {
        vizHLA(data);
        createHLAGraphicsA();
        createHLAGraphicsB();
        createHLAGraphicsC();
        createHLAGraphicsDPA();
        createHLAGraphicsDPB();
        createHLAGraphicsDQA();
        createHLAGraphicsDQB();
        createHLAGraphicsDRB();
    });

    
   
    
    function vizHLA(data)
    {
        // Convert Data to Array:::
        HLAData = _.toArray(data);
    }


    function createHLAGraphicsA()
    {
        var margin = {top: 10, right: 20, bottom: 95, left: 50},
            width = 1000 - margin.left - margin.right,
            height = 350 - margin.top - margin.bottom;

        var x = d3.scale.ordinal()
                .rangeRoundBands([0, width], .1);

        var y = d3.scale.linear()
                .range([height, 0]);

        var xAxis = d3.svg.axis()
                    .scale(x)
                    .orient("bottom");

        var yAxis = d3.svg.axis()
                    .scale(y)
                    .orient("left")
                    .tickFormat(d3.format("d"));

        var tip = d3.tip()
                      .attr('class', 'd3-tip')
                      .offset([-10, 0])
                      .html(function(d) {
                        return "<strong>"+d.allele+"</strong>";
                      }); 

        var A_Allele1 = [];
        var sorted_A_Allele1 = [];

        for(var i = 0; i < HLAData.length; i++)
        {
            A_Allele1.push(HLAData[i].HLA_A_allele1);  
            A_Allele1.push(HLAData[i].HLA_A_allele2);
        }

        //console.log('HLA A Allele1:::', A_Allele1);


        A_Allele1.sort();
        //console.log('Sorted:::', A_Allele1);

        var histogramData = _.countBy(A_Allele1);

        //console.log('Alleles:::', _.keys(histogramData));
        //console.log('Freq:::', _.values(histogramData));

        var histogramAlleles = _.toArray(_.keys(histogramData));
        var histogramValues = _.toArray(_.values(histogramData));
        var finalData = [];

        for(var i = 0; i < histogramAlleles.length; i++)
        {
            var obj = {allele: histogramAlleles[i], freq:histogramValues[i]};
            finalData.push(obj);
        }

        var viz = d3.select('#chart1');


        var svg = viz.append('svg')
                    .attr("id", "chart1-svg")
                    .attr("width", width + margin.left + margin.right)
                    .attr("height", height + margin.top + margin.bottom)
                    .append("g")
                    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
        

        svg.call(tip);

        //Generate graph...
        var yval = d3.scale.linear()
                    .domain([0, d3.max(finalData, function(dd) { return dd.freq; })])
                    .range([height, 0]);

        var xval = d3.scale.ordinal()
                    .domain(histogramAlleles.map(function(d) { return d.allele; }))
                    .range([width/finalData.length]);

      
        x.domain(finalData.map(function(d) { return d.allele; }));
        y.domain([0, d3.max(finalData, function(dd) { return dd.freq; })]);
        

        svg.append("g")
          .attr("class", "x axis")
          .attr("transform", "translate(0," + height + ")")
          .style("font-size", "medium")
          .call(xAxis)
          .selectAll("text")
          .attr("y", 0)
          .attr("x", 9)
            .attr("dy", ".35em")
          .attr("transform", "rotate(90)")
          .style("text-anchor", "start");

        svg.append("g")
          .attr("class", "y axis")
          .call(yAxis);


        svg.selectAll(".bar")
            .data(finalData)
            .enter().append("rect")
            .attr("class", "bar")
            .attr("x", function(d) { return x(d.allele); })
            .attr("width", (0.85 * width)/(finalData.length+0.5))
            .attr("y", function(d) { 
                    return yval(d.freq); 
            })
            .attr("height", function(d) { 
                    return height - yval(d.freq); 
            })
            .on('mouseover', tip.show)
            .on('mouseout', tip.hide); 


        svg.append("text")
          .attr("transform", "rotate(-90)")
          .attr("y", 0 - margin.left)
          .attr("x",0 - (height / 2))
          .attr("dy", "1em")
          .style("text-anchor", "middle")
          .style("font-size", "medium")
          .text("Counts");

    }


    function createHLAGraphicsB()
    {
        var margin = {top: 10, right: 20, bottom: 95, left: 50},
            width = 1000 - margin.left - margin.right,
            height = 350 - margin.top - margin.bottom;

        var x = d3.scale.ordinal()
                .rangeRoundBands([0, width], .1);

        var y = d3.scale.linear()
                .range([height, 0]);

        var xAxis = d3.svg.axis()
                    .scale(x)
                    .orient("bottom");

        var yAxis = d3.svg.axis()
                    .scale(y)
                    .orient("left")
                    .tickFormat(d3.format("d"));

        var tip = d3.tip()
                      .attr('class', 'd3-tip')
                      .offset([-10, 0])
                      .html(function(d) {
                        return "<strong>"+d.allele+"</strong>";
                      }); 

        var B_Allele1 = [];
        var sorted_B_Allele1 = [];

        for(var i = 0; i < HLAData.length; i++)
        {
            B_Allele1.push(HLAData[i].HLA_B_allele1);  
            B_Allele1.push(HLAData[i].HLA_B_allele2);
        }    

        //console.log('HLA B Allele1:::', B_Allele1);


        B_Allele1.sort();
        //console.log('Sorted:::', B_Allele1);

        var histogramData = _.countBy(B_Allele1);

        //console.log('Alleles:::', _.keys(histogramData));
        //console.log('Freq:::', _.values(histogramData));

        var histogramAlleles = _.toArray(_.keys(histogramData));
        var histogramValues = _.toArray(_.values(histogramData));
        var finalData = [];

        for(var i = 0; i < histogramAlleles.length; i++)
        {
            var obj = {allele: histogramAlleles[i], freq:histogramValues[i]};
            finalData.push(obj);
        }

        var viz = d3.select('#chart2');


        var svg = viz.append('svg')
                    .attr("id", "chart1-svg")
                    .attr("width", width + margin.left + margin.right)
                    .attr("height", height + margin.top + margin.bottom)
                    .append("g")
                    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
        

        svg.call(tip);

        //Generate graph...
        var yval = d3.scale.linear()
                    .domain([0, d3.max(finalData, function(dd) { return dd.freq; })])
                    .range([height, 0]);

        var xval = d3.scale.ordinal()
                    .domain(histogramAlleles.map(function(d) { return d.allele; }))
                    .range([width/finalData.length]);

      
        x.domain(finalData.map(function(d) { return d.allele; }));
        y.domain([0, d3.max(finalData, function(dd) { return dd.freq; })]);
        

        svg.append("g")
          .attr("class", "x axis")
          .attr("transform", "translate(0," + height + ")")
          .style("font-size", "medium")
          .call(xAxis)
          .selectAll("text")
          .attr("y", 0)
          .attr("x", 9)
            .attr("dy", ".35em")
          .attr("transform", "rotate(90)")
          .style("text-anchor", "start");

        svg.append("g")
          .attr("class", "y axis")
          .call(yAxis);


        svg.selectAll(".bar")
            .data(finalData)
            .enter().append("rect")
            .attr("class", "bar")
            .attr("x", function(d) { return x(d.allele); })
            .attr("width", (0.85 * width)/(finalData.length+0.5))
            .attr("y", function(d) { 
                    return yval(d.freq); 
            })
            .attr("height", function(d) { 
                    return height - yval(d.freq); 
            })
            .on('mouseover', tip.show)
            .on('mouseout', tip.hide); 


        svg.append("text")
          .attr("transform", "rotate(-90)")
          .attr("y", 0 - margin.left)
          .attr("x",0 - (height / 2))
          .attr("dy", "1em")
          .style("text-anchor", "middle")
          .style("font-size", "medium")
          .text("Counts");

    }


    function createHLAGraphicsC()
    {
        var margin = {top: 10, right: 20, bottom: 95, left: 50},
            width = 1000 - margin.left - margin.right,
            height = 350 - margin.top - margin.bottom;

        var x = d3.scale.ordinal()
                .rangeRoundBands([0, width], .1);

        var y = d3.scale.linear()
                .range([height, 0]);

        var xAxis = d3.svg.axis()
                    .scale(x)
                    .orient("bottom");

        var yAxis = d3.svg.axis()
                    .scale(y)
                    .orient("left")
                    .tickFormat(d3.format("d"));

        var tip = d3.tip()
                      .attr('class', 'd3-tip')
                      .offset([-10, 0])
                      .html(function(d) {
                        return "<strong>"+d.allele+"</strong>";
                      }); 

        var C_Allele1 = [];
        var sorted_C_Allele1 = [];

        for(var i = 0; i < HLAData.length; i++)
        {
            C_Allele1.push(HLAData[i].HLA_C_allele1);  
            C_Allele1.push(HLAData[i].HLA_C_allele2);
        }    

        //console.log('HLA C Allele1:::', C_Allele1);


        C_Allele1.sort();
        //console.log('Sorted:::', C_Allele1);

        var histogramData = _.countBy(C_Allele1);

        //console.log('Alleles:::', _.keys(histogramData));
        //console.log('Freq:::', _.values(histogramData));

        var histogramAlleles = _.toArray(_.keys(histogramData));
        var histogramValues = _.toArray(_.values(histogramData));
        var finalData = [];

        for(var i = 0; i < histogramAlleles.length; i++)
        {
            var obj = {allele: histogramAlleles[i], freq:histogramValues[i]};
            
            if(obj.allele != "")
                finalData.push(obj);
        }

        var viz = d3.select('#chart3');


        var svg = viz.append('svg')
                    .attr("id", "chart1-svg")
                    .attr("width", width + margin.left + margin.right)
                    .attr("height", height + margin.top + margin.bottom)
                    .append("g")
                    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
        

        svg.call(tip);

        //Generate graph...
        var yval = d3.scale.linear()
                    .domain([0, d3.max(finalData, function(dd) { return dd.freq; })])
                    .range([height, 0]);

        var xval = d3.scale.ordinal()
                    .domain(histogramAlleles.map(function(d) { return d.allele; }))
                    .range([width/finalData.length]);

      
        x.domain(finalData.map(function(d) { return d.allele; }));
        y.domain([0, d3.max(finalData, function(dd) { return dd.freq; })]);
        

        svg.append("g")
          .attr("class", "x axis")
          .attr("transform", "translate(0," + height + ")")
          .style("font-size", "medium")
          .call(xAxis)
          .selectAll("text")
          .attr("y", 0)
          .attr("x", 9)
            .attr("dy", ".35em")
          .attr("transform", "rotate(90)")
          .style("text-anchor", "start");

        svg.append("g")
          .attr("class", "y axis")
          .call(yAxis);


        svg.selectAll(".bar")
            .data(finalData)
            .enter().append("rect")
            .attr("class", "bar")
            .attr("x", function(d) { return x(d.allele); })
            .attr("width", (0.8 * width)/(finalData.length+0.5))
            .attr("y", function(d) { 
                    return yval(d.freq); 
            })
            .attr("height", function(d) { 
                    return height - yval(d.freq); 
            })
            .on('mouseover', tip.show)
            .on('mouseout', tip.hide); 


        svg.append("text")
          .attr("transform", "rotate(-90)")
          .attr("y", 0 - margin.left)
          .attr("x",0 - (height / 2))
          .attr("dy", "1em")
          .style("text-anchor", "middle")
          .style("font-size", "medium")
          .text("Counts");
    }


    function createHLAGraphicsDPA()
    {
        var margin = {top: 10, right: 20, bottom: 115, left: 50},
            width = 400 - margin.left - margin.right,
            height = 350 - margin.top - margin.bottom;

        var x = d3.scale.ordinal()
                .rangeRoundBands([0, width], .1);

        var y = d3.scale.linear()
                .range([height, 0]);

        var xAxis = d3.svg.axis()
                    .scale(x)
                    .orient("bottom");

        var yAxis = d3.svg.axis()
                    .scale(y)
                    .orient("left")
                    .tickFormat(d3.format("d"));

        var tip = d3.tip()
                      .attr('class', 'd3-tip')
                      .offset([-10, 0])
                      .html(function(d) {
                        return "<strong>"+d.allele+"</strong>";
                      }); 

        var DPA_Allele1 = [];
        var sorted_DPA_Allele1 = [];

        for(var i = 0; i < HLAData.length; i++)
        {
            DPA_Allele1.push(HLAData[i].HLA_DPA1_allele1);  
            DPA_Allele1.push(HLAData[i].HLA_DPA1_allele2);
        }    

        //console.log('HLA DPA Allele1:::', DPA_Allele1);


        DPA_Allele1.sort();
        //console.log('Sorted:::', DPA_Allele1);

        var histogramData = _.countBy(DPA_Allele1);

        //console.log('Alleles:::', _.keys(histogramData));
        //console.log('Freq:::', _.values(histogramData));

        var histogramAlleles = _.toArray(_.keys(histogramData));
        var histogramValues = _.toArray(_.values(histogramData));
        var finalData = [];

        for(var i = 0; i < histogramAlleles.length; i++)
        {
            var obj = {allele: histogramAlleles[i], freq:histogramValues[i]};
            
            if(obj.allele != "")
                finalData.push(obj);
        }

        var viz = d3.select('#chart4');


        var svg = viz.append('svg')
                    .attr("id", "chart1-svg")
                    .attr("width", width + margin.left + margin.right)
                    .attr("height", height + margin.top + margin.bottom)
                    .append("g")
                    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
        

        svg.call(tip);

        //Generate graph...
        var yval = d3.scale.linear()
                    .domain([0, d3.max(finalData, function(dd) { return dd.freq; })])
                    .range([height, 0]);

        var xval = d3.scale.ordinal()
                    .domain(histogramAlleles.map(function(d) { return d.allele; }))
                    .range([width/finalData.length]);

      
        x.domain(finalData.map(function(d) { return d.allele; }));
        y.domain([0, d3.max(finalData, function(dd) { return dd.freq; })]);
        

        svg.append("g")
          .attr("class", "x axis")
          .attr("transform", "translate(0," + height + ")")
          .style("font-size", "medium")
          .call(xAxis)
          .selectAll("text")
          .attr("y", 0)
          .attr("x", 9)
            .attr("dy", ".35em")
          .attr("transform", "rotate(90)")
          .style("text-anchor", "start");

        svg.append("g")
          .attr("class", "y axis")
          .call(yAxis);


        svg.selectAll(".bar")
            .data(finalData)
            .enter().append("rect")
            .attr("class", "bar")
            .attr("x", function(d,i) { 
                var rawWidth = (0.8 * width)/(finalData.length+0.5);
                //if(rawWidth > 50) 
                //        return (i * 60) + 20;
                //    else    
                return x(d.allele); 
            })
            .attr("width", function(d) {                
                var rawWidth = (0.85 * width)/(finalData.length+0.5);
                    //if(rawWidth > 50) 
                    //    return 50;
                    //else    
                        return rawWidth;
            })
            .attr("y", function(d) { 
                    return yval(d.freq); 
            })
            .attr("height", function(d) { 
                    return height - yval(d.freq); 
            })
            .on('mouseover', tip.show)
            .on('mouseout', tip.hide); 


        svg.append("text")
          .attr("transform", "rotate(-90)")
          .attr("y", 0 - margin.left)
          .attr("x",0 - (height / 2))
          .attr("dy", "1em")
          .style("text-anchor", "middle")
          .style("font-size", "medium")
          .text("Counts");
    }


    function createHLAGraphicsDPB()
    {
        var margin = {top: 10, right: 20, bottom: 120, left: 50},
            width = 1000 - margin.left - margin.right,
            height = 350 - margin.top - margin.bottom;

        var x = d3.scale.ordinal()
                .rangeRoundBands([0, width], .1);

        var y = d3.scale.linear()
                .range([height, 0]);

        var xAxis = d3.svg.axis()
                    .scale(x)
                    .orient("bottom");

        var yAxis = d3.svg.axis()
                    .scale(y)
                    .orient("left")
                    .tickFormat(d3.format("d"));

        var tip = d3.tip()
                      .attr('class', 'd3-tip')
                      .offset([-10, 0])
                      .html(function(d) {
                        return "<strong>"+d.allele+"</strong>";
                      }); 

        var DPB_Allele1 = [];
        var sorted_DPB_Allele1 = [];

        for(var i = 0; i < HLAData.length; i++)
        {
            DPB_Allele1.push(HLAData[i].HLA_DPB1_allele1);  
            DPB_Allele1.push(HLAData[i].HLA_DPB1_allele2);
        }    

        //console.log('HLA DPB Allele1:::', DPB_Allele1);


        DPB_Allele1.sort();
        //console.log('Sorted:::', DPB_Allele1);

        var histogramData = _.countBy(DPB_Allele1);

        //console.log('Alleles:::', _.keys(histogramData));
        //console.log('Freq:::', _.values(histogramData));

        var histogramAlleles = _.toArray(_.keys(histogramData));
        var histogramValues = _.toArray(_.values(histogramData));
        var finalData = [];

        for(var i = 0; i < histogramAlleles.length; i++)
        {
            var obj = {allele: histogramAlleles[i], freq:histogramValues[i]};
            
            if(obj.allele != "")
                finalData.push(obj);
        }

        var viz = d3.select('#chart5');


        var svg = viz.append('svg')
                    .attr("id", "chart1-svg")
                    .attr("width", width + margin.left + margin.right)
                    .attr("height", height + margin.top + margin.bottom)
                    .append("g")
                    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
        

        svg.call(tip);

        //Generate graph...
        var yval = d3.scale.linear()
                    .domain([0, d3.max(finalData, function(dd) { return dd.freq; })])
                    .range([height, 0]);

        var xval = d3.scale.ordinal()
                    .domain(histogramAlleles.map(function(d) { return d.allele; }))
                    .range([width/finalData.length]);

      
        x.domain(finalData.map(function(d) { return d.allele; }));
        y.domain([0, d3.max(finalData, function(dd) { return dd.freq; })]);
        

        svg.append("g")
          .attr("class", "x axis")
          .attr("transform", "translate(0," + height + ")")
          .style("font-size", "medium")
          .call(xAxis)
          .selectAll("text")
          .attr("y", 0)
          .attr("x", 9)
            .attr("dy", ".35em")
          .attr("transform", "rotate(90)")
          .style("text-anchor", "start");

        svg.append("g")
          .attr("class", "y axis")
          .call(yAxis);


        svg.selectAll(".bar")
            .data(finalData)
            .enter().append("rect")
            .attr("class", "bar")
            .attr("x", function(d,i) {   
                return x(d.allele); 
            })
            .attr("width", function(d) {                
                var rawWidth = (0.85 * width)/(finalData.length+0.5);  
                return rawWidth;
            })
            .attr("y", function(d) { 
                    return yval(d.freq); 
            })
            .attr("height", function(d) { 
                    return height - yval(d.freq); 
            })
            .on('mouseover', tip.show)
            .on('mouseout', tip.hide); 


        svg.append("text")
          .attr("transform", "rotate(-90)")
          .attr("y", 0 - margin.left)
          .attr("x",0 - (height / 2))
          .attr("dy", "1em")
          .style("text-anchor", "middle")
          .style("font-size", "medium")
          .text("Counts");
    }


    function createHLAGraphicsDQA()
    {
        var margin = {top: 10, right: 20, bottom: 115, left: 50},
            width = 400 - margin.left - margin.right,
            height = 350 - margin.top - margin.bottom;

        var x = d3.scale.ordinal()
                .rangeRoundBands([0, width], .1);

        var y = d3.scale.linear()
                .range([height, 0]);

        var xAxis = d3.svg.axis()
                    .scale(x)
                    .orient("bottom");

        var yAxis = d3.svg.axis()
                    .scale(y)
                    .orient("left")
                    .tickFormat(d3.format("d"));

        var tip = d3.tip()
                      .attr('class', 'd3-tip')
                      .offset([-10, 0])
                      .html(function(d) {
                        return "<strong>"+d.allele+"</strong>";
                      }); 

        var DQA_Allele1 = [];
        var sorted_DQA_Allele1 = [];

        for(var i = 0; i < HLAData.length; i++)
        {
            DQA_Allele1.push(HLAData[i].HLA_DQA1_allele1);  
            DQA_Allele1.push(HLAData[i].HLA_DQA1_allele2);
        }    

        //console.log('HLA DQA Allele1:::', DQA_Allele1);


        DQA_Allele1.sort();
        //console.log('Sorted:::', DQA_Allele1);

        var histogramData = _.countBy(DQA_Allele1);

        //console.log('Alleles:::', _.keys(histogramData));
        //console.log('Freq:::', _.values(histogramData));

        var histogramAlleles = _.toArray(_.keys(histogramData));
        var histogramValues = _.toArray(_.values(histogramData));
        var finalData = [];

        for(var i = 0; i < histogramAlleles.length; i++)
        {
            var obj = {allele: histogramAlleles[i], freq:histogramValues[i]};
            
            if(obj.allele != "")
                finalData.push(obj);
        }

        var viz = d3.select('#chart6');


        var svg = viz.append('svg')
                    .attr("id", "chart1-svg")
                    .attr("width", width + margin.left + margin.right)
                    .attr("height", height + margin.top + margin.bottom)
                    .append("g")
                    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
        

        svg.call(tip);

        //Generate graph...
        var yval = d3.scale.linear()
                    .domain([0, d3.max(finalData, function(dd) { return dd.freq; })])
                    .range([height, 0]);

        var xval = d3.scale.ordinal()
                    .domain(histogramAlleles.map(function(d) { return d.allele; }))
                    .range([width/finalData.length]);

      
        x.domain(finalData.map(function(d) { return d.allele; }));
        y.domain([0, d3.max(finalData, function(dd) { return dd.freq; })]);
        

        svg.append("g")
          .attr("class", "x axis")
          .attr("transform", "translate(0," + height + ")")
          .style("font-size", "medium")
          .call(xAxis)
          .selectAll("text")
          .attr("y", 0)
          .attr("x", 9)
            .attr("dy", ".35em")
          .attr("transform", "rotate(90)")
          .style("text-anchor", "start");

        svg.append("g")
          .attr("class", "y axis")
          .call(yAxis);


        svg.selectAll(".bar")
            .data(finalData)
            .enter().append("rect")
            .attr("class", "bar")
            .attr("x", function(d,i) {   
                return x(d.allele); 
            })
            .attr("width", function(d) {                
                var rawWidth = (0.85 * width)/(finalData.length+0.5);  
                return rawWidth;
            })
            .attr("y", function(d) { 
                    return yval(d.freq); 
            })
            .attr("height", function(d) { 
                    return height - yval(d.freq); 
            })
            .on('mouseover', tip.show)
            .on('mouseout', tip.hide); 


        svg.append("text")
          .attr("transform", "rotate(-90)")
          .attr("y", 0 - margin.left)
          .attr("x",0 - (height / 2))
          .attr("dy", "1em")
          .style("text-anchor", "middle")
          .style("font-size", "medium")
          .text("Counts");
    }


    function createHLAGraphicsDQB()
    {
        var margin = {top: 10, right: 20, bottom: 120, left: 50},
            width = 400 - margin.left - margin.right,
            height = 350 - margin.top - margin.bottom;

        var x = d3.scale.ordinal()
                .rangeRoundBands([0, width], .1);

        var y = d3.scale.linear()
                .range([height, 0]);

        var xAxis = d3.svg.axis()
                    .scale(x)
                    .orient("bottom");

        var yAxis = d3.svg.axis()
                    .scale(y)
                    .orient("left")
                    .tickFormat(d3.format("d"));

        var tip = d3.tip()
                      .attr('class', 'd3-tip')
                      .offset([-10, 0])
                      .html(function(d) {
                        return "<strong>"+d.allele+"</strong>";
                      }); 

        var DQB_Allele1 = [];
        var sorted_DQB_Allele1 = [];

        for(var i = 0; i < HLAData.length; i++)
        {
            DQB_Allele1.push(HLAData[i].HLA_DQB1_allele1);  
            DQB_Allele1.push(HLAData[i].HLA_DQB1_allele2);
        }    

        //console.log('HLA DQB Allele1:::', DQB_Allele1);


        DQB_Allele1.sort();
        //console.log('Sorted:::', DQB_Allele1);

        var histogramData = _.countBy(DQB_Allele1);

        //console.log('Alleles:::', _.keys(histogramData));
        //console.log('Freq:::', _.values(histogramData));

        var histogramAlleles = _.toArray(_.keys(histogramData));
        var histogramValues = _.toArray(_.values(histogramData));
        var finalData = [];

        for(var i = 0; i < histogramAlleles.length; i++)
        {
            var obj = {allele: histogramAlleles[i], freq:histogramValues[i]};
            
            if(obj.allele != "")
                finalData.push(obj);
        }

        var viz = d3.select('#chart7');


        var svg = viz.append('svg')
                    .attr("id", "chart1-svg")
                    .attr("width", width + margin.left + margin.right)
                    .attr("height", height + margin.top + margin.bottom)
                    .append("g")
                    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
        

        svg.call(tip);

        //Generate graph...
        var yval = d3.scale.linear()
                    .domain([0, d3.max(finalData, function(dd) { return dd.freq; })])
                    .range([height, 0]);

        var xval = d3.scale.ordinal()
                    .domain(histogramAlleles.map(function(d) { return d.allele; }))
                    .range([width/finalData.length]);

      
        x.domain(finalData.map(function(d) { return d.allele; }));
        y.domain([0, d3.max(finalData, function(dd) { return dd.freq; })]);
        

        svg.append("g")
          .attr("class", "x axis")
          .attr("transform", "translate(0," + height + ")")
          .style("font-size", "medium")
          .call(xAxis)
          .selectAll("text")
          .attr("y", 0)
          .attr("x", 9)
            .attr("dy", ".35em")
          .attr("transform", "rotate(90)")
          .style("text-anchor", "start");

        svg.append("g")
          .attr("class", "y axis")
          .call(yAxis);


        svg.selectAll(".bar")
            .data(finalData)
            .enter().append("rect")
            .attr("class", "bar")
            .attr("x", function(d,i) {   
                return x(d.allele); 
            })
            .attr("width", function(d) {                
                var rawWidth = (0.85 * width)/(finalData.length+0.5);  
                return rawWidth;
            })
            .attr("y", function(d) { 
                    return yval(d.freq); 
            })
            .attr("height", function(d) { 
                    return height - yval(d.freq); 
            })
            .on('mouseover', tip.show)
            .on('mouseout', tip.hide); 


        svg.append("text")
          .attr("transform", "rotate(-90)")
          .attr("y", 0 - margin.left)
          .attr("x",0 - (height / 2))
          .attr("dy", "1em")
          .style("text-anchor", "middle")
          .style("font-size", "medium")
          .text("Counts");
    }


    function createHLAGraphicsDRB()
    {
        var margin = {top: 10, right: 20, bottom: 120, left: 50},
            width = 1000 - margin.left - margin.right,
            height = 350 - margin.top - margin.bottom;

        var x = d3.scale.ordinal()
                .rangeRoundBands([0, width], .1);

        var y = d3.scale.linear()
                .range([height, 0]);

        var xAxis = d3.svg.axis()
                    .scale(x)
                    .orient("bottom");

        var yAxis = d3.svg.axis()
                    .scale(y)
                    .orient("left")
                    .tickFormat(d3.format("d"));

        var tip = d3.tip()
                      .attr('class', 'd3-tip')
                      .offset([-10, 0])
                      .html(function(d) {
                        return "<strong>"+d.allele+"</strong>";
                      }); 

        var DRB_Allele1 = [];
        var sorted_DRB_Allele1 = [];

        for(var i = 0; i < HLAData.length; i++)
        {
            DRB_Allele1.push(HLAData[i].HLA_DRB1_allele1);  
            DRB_Allele1.push(HLAData[i].HLA_DRB1_allele2);
        }    

        //console.log('HLA DRB Allele1:::', DRB_Allele1);


        DRB_Allele1.sort();
        //console.log('Sorted:::', DRB_Allele1);

        var histogramData = _.countBy(DRB_Allele1);

        //console.log('Alleles:::', _.keys(histogramData));
        //console.log('Freq:::', _.values(histogramData));

        var histogramAlleles = _.toArray(_.keys(histogramData));
        var histogramValues = _.toArray(_.values(histogramData));
        var finalData = [];

        for(var i = 0; i < histogramAlleles.length; i++)
        {
            var obj = {allele: histogramAlleles[i], freq:histogramValues[i]};
            
            if(obj.allele != "")
                finalData.push(obj);
        }

        var viz = d3.select('#chart8');


        var svg = viz.append('svg')
                    .attr("id", "chart1-svg")
                    .attr("width", width + margin.left + margin.right)
                    .attr("height", height + margin.top + margin.bottom)
                    .append("g")
                    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
        

        svg.call(tip);

        //Generate graph...
        var yval = d3.scale.linear()
                    .domain([0, d3.max(finalData, function(dd) { return dd.freq; })])
                    .range([height, 0]);

        var xval = d3.scale.ordinal()
                    .domain(histogramAlleles.map(function(d) { return d.allele; }))
                    .range([width/finalData.length]);

      
        x.domain(finalData.map(function(d) { return d.allele; }));
        y.domain([0, d3.max(finalData, function(dd) { return dd.freq; })]);
        

        svg.append("g")
          .attr("class", "x axis")
          .attr("transform", "translate(0," + height + ")")
          .style("font-size", "medium")
          .call(xAxis)
          .selectAll("text")
          .attr("y", 0)
          .attr("x", 9)
            .attr("dy", ".35em")
          .attr("transform", "rotate(90)")
          .style("text-anchor", "start");

        svg.append("g")
          .attr("class", "y axis")
          .call(yAxis);


        svg.selectAll(".bar")
            .data(finalData)
            .enter().append("rect")
            .attr("class", "bar")
            .attr("x", function(d,i) {   
                return x(d.allele); 
            })
            .attr("width", function(d) {                
                var rawWidth = (0.85 * width)/(finalData.length+0.5);  
                return rawWidth;
            })
            .attr("y", function(d) { 
                    return yval(d.freq); 
            })
            .attr("height", function(d) { 
                    return height - yval(d.freq); 
            })
            .on('mouseover', tip.show)
            .on('mouseout', tip.hide); 


        svg.append("text")
          .attr("transform", "rotate(-90)")
          .attr("y", 0 - margin.left)
          .attr("x",0 - (height / 2))
          .attr("dy", "1em")
          .style("text-anchor", "middle")
          .style("font-size", "medium")
          .text("Counts");
    }


    
    

</script>

</head>



<body role="document" style="background: #eee;">

<nav class="navbar navbar-inverse navbar-fixed-top" style= "margin-botom:0px;">

    <div class="container-fluid" style = "background: #1974B8;">
        
        <div id="navbar">
            <ul class="nav navbar-nav" style="margin-left:100px;">
                <li> 
                    <a href="index.html" style="padding:0px;"> <img src="images/Logo.png" alt="ImmuneRegulation" height="40" style="margin-right: 10px; margin-top:5px;"> </a> 
                </li>
                
                <li>   
                    <a href="index.html" class="navbar-brand" style="color: white;" role="button" aria-expanded="false">ImmuneRegulation </a>
                </li>
            </ul>

            <ul class="nav navbar-nav">
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle navbar-brand" style="color: white; margin-left: 10px; opacity:0.5;" data-toggle="dropdown" role="button" aria-expanded="false">Example Queries&nbsp&nbsp&nbsp
                        </a>
                    
                </li>
            </ul>

            <ul class="nav navbar-nav">
                <li><a class="navbar-brand" style="color: white; margin-left: 10px;" href="metadata-all.html">Query Meta-data</a>
                    
                    </a>
                </li>
                
            </ul>

            <ul class="nav navbar-nav">
                <li><a class="navbar-brand" style="color: white; margin-left: 10px;" href="tutorials.html">Tutorials</a>
                    
                    </a>
                </li>
                
            </ul>

            <ul class="nav navbar-nav">
                <li><a class="navbar-brand" style="color: white; margin-left: 10px;" href="feedback.html">Contact Us</a>
                    
                    </a>
                </li>
                
            </ul>

            <ul class="nav navbar-nav">
                <li><a class="navbar-brand" style="color: white; margin-left: 10px;" href="faq.html">FAQ</a>
                    
                    </a>
                </li>
                
            </ul>

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="http://www.mssm.edu" target="_blank" style = "padding-top: 0px; padding-bottom: 0px; margin-left: 10px;">
                        <img src="images/logo.gif" alt="Mount Sinai" height="40" style = "margin-left: 10px; margin-right: 100px; margin-top:5px; margin-bottom:5px;">
                    </a> 
                </li>
                
            </ul>

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a class="navbar-brand" target="_blank" style="color: white; margin-left: 10px; margin-right: 30px;" href="https://www.immunespace.org/">ImmuneSpace </a>
                </li>
            </ul>
            

        </div>
        <!--/.nav-collapse -->
    </div>

</nav>




<div class="container-fluid" id = "mainContainer" style="background: white; padding-bottom: 10px; margin-top: 70px; margin-bottom:70px; width:60%"> <!-- container start -->

    <div class="row" id="geneEntryRow" style="margin-top: 10px;margin-left:-5px;margin-right:-5px; padding-top:10px;">
        
        <div class="col-md-3">
        </div>

        <div class="col-md-8" style=" padding-top:10px; font-size:1.1vw; padding-left:0px;">
            <h4 style="font-size:1.1vw;"> Zika Infection Study HLA Types Counts Summary (n = 89)</h4>

        </div>
 
    
    </div>

    
<div id = "allGraphics">
    
    <div class="row" style="background: white; padding-bottom: 0px; margin-top: 10px; font-family:serif;"> 
        <div class="col-md-11">
            <h4 style = "margin-left: 50px; font-size:1.0vw;text-align:center;margin:0px;"> <strong> HLA-A </strong> </h4>
        </div>
    </div>

    <div class="row" style="background: white; padding-bottom: 0px; margin-top: 0px; font-family:serif;">
        <div class="col-md-9" style="background: white; padding-bottom: 0px; margin-top: 0px; font-family:serif;"> 
            <div id="chart1" style = "margin-left: 10px;"></div>
        </div>
    </div>


    <div>
    <div class="row" style="background: white; padding-bottom: 0px; margin-top: 10px; font-family:serif;"> 
        <div class="col-md-11">
            <h4 style = "margin-left: 50px; font-size:1.0vw;text-align:center;margin:0px;"> <strong> HLA-B </strong> </h4>
        </div>
    </div>

    <div class="row" style="background: white; padding-bottom: 0px; margin-top: 0px; font-family:serif;">
        <div class="col-md-9" style="background: white; padding-bottom: 0px; margin-top: 0px; font-family:serif;"> 
            <div id="chart2" style = "margin-left: 10px;"></div>
        </div>
    </div>
    </div>

    <div class="row" style="background: white; padding-bottom: 0px; margin-top: 10px; font-family:serif;"> 
        <div class="col-md-11">
            <h4 style = "margin-left: 50px; font-size:1.0vw;text-align:center;margin:0px;"> <strong> HLA-C </strong> </h4>
        </div>
    </div>

    <div class="row" style="background: white; padding-bottom: 0px; margin-top: 0px; font-family:serif;">
        <div class="col-md-9" style="background: white; padding-bottom: 0px; margin-top: 0px; font-family:serif;"> 
            <div id="chart3" style = "margin-left: 10px;"></div>
        </div>
    </div>

    <div class="row" style="background: white; padding-bottom: 0px; margin-top: 10px; font-family:serif;"> 

        <div class="col-md-11">
            <h4 style = "margin-left: 50px; font-size:1.0vw;text-align:center;margin:0px;"> <strong> HLA-DPA1 </strong> </h4>
        </div>
    </div>

    <div class="row" style="background: white; padding-bottom: 0px; margin-top: 0px; font-family:serif;">
        <div class="col-md-3">
        </div>
        <div class="col-md-9" style="background: white; padding-bottom: 0px; margin-top: 0px; font-family:serif;"> 
            <div id="chart4" style = "margin-left: 10px;"></div>
        </div>
    </div>

    <div class="row" style="background: white; padding-bottom: 0px; margin-top: 10px; font-family:serif;"> 
        <div class="col-md-11">
            <h4 style = "margin-left: 50px; font-size:1.0vw;text-align:center;margin:0px;"> <strong> HLA-DPB1 </strong> </h4>
        </div>
    </div>

    <div class="row" style="background: white; padding-bottom: 0px; margin-top: 0px; font-family:serif;">
        <div class="col-md-9" style="background: white; padding-bottom: 0px; margin-top: 0px; font-family:serif;"> 
            <div id="chart5" style = "margin-left: 10px;"></div>
        </div>
    </div>

    <div class="row" style="background: white; padding-bottom: 0px; margin-top: 10px; font-family:serif;"> 
        <div class="col-md-11">
            <h4 style = "margin-left: 50px; font-size:1.0vw;text-align:center;margin:0px;"> <strong> HLA-DQA1 </strong> </h4>
        </div>
    </div>

    <div class="row" style="background: white; padding-bottom: 0px; margin-top: 0px; font-family:serif;">
        <div class="col-md-3">
        </div>
        <div class="col-md-9" style="background: white; padding-bottom: 0px; margin-top: 0px; font-family:serif;"> 
            <div id="chart6" style = "margin-left: 10px;"></div>
        </div>
    </div>

    <div class="row" style="background: white; padding-bottom: 0px; margin-top: 10px; font-family:serif;"> 
        <div class="col-md-11">
            <h4 style = "margin-left: 50px; font-size:1.0vw;text-align:center;margin:0px;"> <strong> HLA-DQB1 </strong> </h4>
        </div>
    </div>

    <div class="row" style="background: white; padding-bottom: 0px; margin-top: 0px; font-family:serif;">
        <div class="col-md-3">
        </div>
        <div class="col-md-9" style="background: white; padding-bottom: 0px; margin-top: 0px; font-family:serif;"> 
            <div id="chart7" style = "margin-left: 10px;"></div>
        </div>
    </div>

    <div class="row" style="background: white; padding-bottom: 0px; margin-top: 10px; font-family:serif;"> 
        <div class="col-md-11">
            <h4 style = "margin-left: 50px; font-size:1.0vw;text-align:center;margin:0px;"> <strong> HLA-DRB1 </strong> </h4>
        </div>
    </div>

    <div class="row" style="background: white; padding-bottom: 0px; margin-top: 0px; font-family:serif;">

        <div class="col-md-9" style="background: white; padding-bottom: 0px; margin-top: 0px; font-family:serif;"> 
            <div id="chart8" style = "margin-left: 10px;"></div>
        </div>
    </div>
    

</div>    

</div>  <!-- container finish-->


<nav class="navbar navbar-inverse navbar-fixed-bottom" style= "margin:5px; border: 1 px solid; border-color: gray; height: 60px;">

    <nav class="nav-upper" style = "background: #3f97ca; height: 60px; padding-top:10px;">
        <div class="container-fluid" style = "text-align:center; color:white; font-size: normal;">
            <ul class="nav navbar-upper">
                <li> ImmuneRegulation <span> | </span> Version 1.0.0 </li>
                <li> <span><a href = "http://research.mssm.edu/gumuslab/" style = "color:white; text-decoration:underline;"> Gm Lab </a></span> 
                    <span> | </span>Icahn School of Medicine at Mount Sinai </li>
            </ul>
        </div>
    </nav>
    

</nav>

<div class="container-fluid">

    <footer>
        <p></p>
    </footer>

</div>


</body>

</html>
